<!DOCTYPE html>
<html>

<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>제품리스트</title>

    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="font-awesome/css/font-awesome.css" rel="stylesheet">

    <link href="css/animate.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">
    <style>
        /* 리스트가 길어졌을 때 footer 하단에 고정시키기 */
        html,body {
            margin: 0;
            padding: 0;
            height: 100%;
        }
        #wrapper {
            min-height: 100%;
            position: relative;
        }
        .content {
            padding-bottom: 0px;
        }

    </style>
</head>

<body>
    <div id="vm" class="content" v-cloak>
        <div id="wrapper">

            <%- include('navigation') %>
            
            <div id="page-wrapper" class="gray-bg">
                <%- include('header') %>
                <div class="row border-bottom" style="margin-top:20px;">
                    <nav class="navbar navbar-static-top gray-bg" role="navigation" style="margin-bottom: 0">
                        <div class="col-lg-12">
                            <div class="ibox float-e-margins">
                                <div class="ibox-title">
                                    <h5>제품 리스트</h5>
                                </div>
                                <div class="ibox-content text-center">
                                    <div class="table-responsive">
                                        <table class="table table-striped">
                                            <thead>
                                                <tr>
                                                    <th>등록번호</th>
                                                    <th width="40%">제품명</th>
                                                    <th>등록날짜</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr v-for="(item, idx) in product">
                                                    <td>{{ item.id }}</td>
                                                    <td>{{ item.product_name }}</td>
                                                    <td>{{ item.createdAt }}</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                        <button type="button" @click="moreList">더보기</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                </div>
            </div>
            <%- include('footer') %>

        </div>
    </div>
    </div>
    <!-- Mainly scripts -->
    <script src="js/jquery-3.1.1.min.js"></script>
    <script src="js/popper.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/plugins/metisMenu/jquery.metisMenu.js"></script>
    <script src="js/plugins/slimscroll/jquery.slimscroll.min.js"></script>

    <!-- Custom and plugin javascript -->
    <script src="js/inspinia.js"></script>
    <script src="js/plugins/pace/pace.min.js"></script>
    <!-- axios -->
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <!-- vue  -->
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>

    <script>
        const vm = new Vue({
            data: {
                title: '제품 리스트',
                product: []
            },
            methods: {
                moreList() {
                    (
                        async () => {
                            try {
                                const result = await axios.get('/products/all')
                                console.log(result.data);
                                // this.product.push(result.data);
                                // 받아온 배열의 객체를 product 배열에 집어 넣어햐 한다.
                                result.data.forEach(item => {
                                    this.product.push(item);
                                });
                                console.log('증가한 배열')
                                console.log(this.product);
                            } catch (err) {
                                console.log(err);
                            }
                        }
                    )();
                }
            },
            created() {
                (
                    async () => {
                        try {
                            const result = await axios.get('/products/all')
                            console.log(result);
                            this.product = result.data;
                        } catch (err) {
                            console.log(err);
                        }
                    }
                )();
            }
        }).$mount('#vm');


    </script>
</body>

</html>